---
layout: post
title: 双芯光纤全耦合情况下，纤芯1、2输出光功率随光纤长度的变化关系
date: 2013-01-09 16:10:40 +0800
categories:
- Matlab
tags:
- TCF
---

%==========================================================================
%Name: tcf_p_z.m，
%Desc: 双芯光纤(全耦合情况),计算纤芯1、2输出功率随光纤长度z的变化情况，
%并画出范林勇博士论文P46，图2.10
%Parameter:
%Return:
%Author: yoyoba(stuyou@126.com)
%Date: 2013-1-9
%Modify: 2013-1-9
%==========================================================================
clear;
close all;
clc;
lamda=1550e-9; %波长为1550nm
a1=4.1e-6; %纤芯1半径
a2=a1; %纤芯2半径
dn=0.005; %纤芯1和包层折射率差
ncl=1.44402; %包层折射率
nco1=ncl+dn; %纤芯1折射率
nco2=nco1; %纤芯2折射率 
jd=8.854e-12; %真空介电常数
dc=4*pi*1.e-7; %真空磁导率
z0=sqrt(dc/jd); %范林勇博士论文P40,公式（2-89）
c=3e+8;
d=[12.e-6,16.e-6]; %纤芯之间距离分比为12微米和16微米
N=length(d);
Nlamda=length(lamda);
Ktemp12=zeros(size(lamda));
Ktemp21=zeros(size(lamda));
K12=zeros(size(lamda));
for j=1:N
    omg=2*pi*c/lamda;    %光场角频率 
    [V1,U1,W1]=f_LP01_V_U_W(nco1,ncl,a1,lamda);
    [V2,U2,W2]=f_LP01_V_U_W(nco2,ncl,a2,lamda);
    E01=sqrt((pi*a1^2*nco1/(2*z0))*(besselj(0,U1)^2+besselj(1,U1)^2+...
    besselj(0,U1)^2*(besselk(1,W1)^2-besselk(0,W1)^2)/besselk(0,W1)^2))^-1;
    %P40,公式（2-89）
    E02=sqrt((pi*a2^2*nco2/(2*z0))*(besselj(0,U2)^2+besselj(1,U2)^2+...
    besselj(0,U2)^2*(besselk(1,W2)^2-besselk(0,W2)^2)/besselk(0,W2)^2))^-1;
    %P40,公式（2-89）
    dtemp=d(j);
    alpha1=asin(a2/dtemp);
    tol=1.e-10;
% Ktemp12(j)=dblquad(@(x,y)(conj((besselj(0,U1)*besselk(0,W1*y/a1)...
% /besselk(0,W1))).*besselj(0,U2*(sqrt(dtemp^2+y.^2-2*dtemp.*...
% y.*cos(x)))/a2).*y).*(y.^2-2*dtemp*y.*cos(x)+dtemp^2-a2^2<=0)...
% ,-alpha1,alpha1,dtemp-a2,dtemp+a2,tol);
% %计算K12的积分部分,柱坐标
    Ktemp12(j)=dblquad(@(x,y)(conj((besselj(0,U1)*besselk(0,W1*sqrt(x.^2+...
        y.^2)/a1)/besselk(0,W1))).*besselj(0,U2*(sqrt((x-dtemp).^2+y.^2))...
        /a2)).*((x-dtemp).^2+y.^2<=a2^2),dtemp-a2,dtemp+a2,-a2,a2,tol); 
    %计算K12的积分部分，直角坐标
    K12(j)=Ktemp12(j)*omg*jd*(nco2^2-ncl^2)*conj(E01)*E02/4;
end
z=0:0.01e-3:20e-3; %双芯光纤长度从0mm到20mm
p11=cos(K12(1)*z).^2;
p12=sin(K12(1)*z).^2;
figure(1);
plot(z*1e+3,p11,'linewidth',2);
hold on;
plot(z*1e+3,p12,'k','linewidth',2);
hold off;
legend('P1(z)','P2(z)');
xlabel('z/mm');
ylabel('Normalized Power/a.u.')
title('d=10mm');
set(get(gca,'title'),'FontSize',20,'FontName','宋体');
set(get(gca,'XLabel'),'FontSize',14,'FontName','Times New Roman');
set(get(gca,'YLabel'),'FontSize',14,'FontName','Times New Roman');
figure(2);
p21=cos(K12(2)*z).^2;
p22=sin(K12(2)*z).^2;
plot(z*1e+3,p21,'linewidth',2);
hold on;
plot(z*1e+3,p22,'k','linewidth',2);
hold off;
legend('P1(z)','P2(z)');
xlabel('z/mm');
ylabel('Normalized Power/a.u.');
title('d=16mm');
set(get(gca,'title'),'FontSize',20,'FontName','宋体');
set(get(gca,'XLabel'),'FontSize',14,'FontName','Times New Roman');
set(get(gca,'YLabel'),'FontSize',14,'FontName','Times New Roman');

![](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/image/tcf_p_z.jpg)

[tcf_p_z.rar](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/data/tcf_p_z.rar)