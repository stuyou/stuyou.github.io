---
layout: post
title: 傅里叶变换法，求高斯脉冲的一阶微分 
date: 2012-07-06 15:10:06 +0800
categories:
- Matlab
tags:
- Gauss
- 微分
---

思路：已知高斯脉冲的时域表达式，然后在时域抽样，经过FFT变换成频域之后，再和一阶微分传输函数jw相乘，再经过IFFT傅里叶逆变换，得到高斯脉冲的一阶微分。该方法可以计算任何时域波形的一阶微分。

```matlab
%==========================================================================
%Name: gauss_diff_ideal.m
%Desc: 傅里叶变换法，计算高斯脉冲的一阶微分，并画出一阶微分传输函数的幅频
% 、相频响应图
%Parameter: 
%Return: 
%Author: yoyoba(stuyou@126.com)
%Date: 2012-6-20
%Modify: 2012-7-3
%=========================================================================
clc;
clear;
T0=10e-12; %脉冲宽度10ps
N=2^12; %取样点数
L=100*T0; %信号时域的长度。使用MATLAB分析信号频谱时，信号时域长度的选
                  %择原则是尽量大。信号时域长度决定了频率的分辨率D
T=L/N; %采样间隔，采样频fs=1/T；采样间隔应满足采样定理的要求。 
n=floor(-(N-1)/2:(N-1)/2);
t=n*T;
g=exp(-0.5*(t/T0).^2); %高斯脉冲
dg=-t.*g/T0^2; %高斯一阶微分，理论表达式

k=floor(-(N-1)/2:(N-1)/2);
D=1/L; %频率分辨率，由信号时域长度决定，单位Hz。
G=fftshift(fft(g,N)); %高斯信号频谱.必须要用fftshift()移位，因为fft()
                          %出来的频谱是0到+，-到0,和微分传输函数相乘时，应先移位。

H=2*pi*1i*(k)*D; %一阶微分传输函数
GG=G.*H; %高斯一阶微分信号的频谱
iGG=ifft(GG,N); %逆变换，计算高斯一阶微分时域信号

subplot(2,2,1);
plot(t*1e+12,g); %高斯脉冲时域图
hold on;
plot(t*1e+12,abs(dg)/max(abs(dg)),'r'); %高斯一阶微分理论结果,归一化
axis([-50,50,0,1]);
xlabel('Time(ps)');
ylabel('Amplitude(a.u.)');
title('gauss&ideal-gauss-diff');

subplot(2,2,2);
plot(t*1e+12,g); %高斯脉冲时域图
hold on;
plot(t*1e+12,abs(iGG)/max(abs(iGG)),'r'); %傅里叶变化法计算得到的高斯一阶微分信号时域图，归一化
axis([-50,50,0,1]);
xlabel('Time(ps)');
ylabel('Amplitude(a.u.)');
title('gauss&gauss-diff givn by FT');

subplot(2,2,3); %一阶微分传输函数幅频响应图
plot(k*D*1e-9,abs(H)/max(abs(H)));
xlabel('Frequency(GHz)');
ylabel('Amplitude(a.u.)');

subplot(2,2,4); %一阶微分传输函数相频响应图
plot(k*D*1e-9,angle(H));
xlabel('Frequency(GHz)');
ylabel('Phase(rad)');
```

结果

![](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/image/gauss-diff.jpg)