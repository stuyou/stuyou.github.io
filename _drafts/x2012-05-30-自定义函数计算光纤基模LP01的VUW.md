---
layout: post
title:  自定义函数，计算光纤基模LP01的V、U、W 
date: 2012-05-30 22:14:07 +0800
categories:
- Matlab
tags:
- LP01模式
---

根据基模LP01的本征方程，已知纤芯折射率、包层折射率、纤芯直径、入射光波长，计算其归一化频率V、横向参数U、W。LP01的特征方程如下：

![](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/image/LP01_ele.jpg)

求解函数如下：

```matlab
%==========================================================================
%Name: [V,U,W]=f_LP01_V_U_W(nco,ncl,a,lamda)
%Desc: 根据LP01模的特征方程,计算基模LP01的U和V值
%Parameter: [in]nco,纤芯折射率
% [in]ncl,包层折射率
% [in]a,纤芯半径
% [in]lamda,入射光波长
%Return:[out]V,返回基模的归一化频率V
% [out]U,返回基模的横向归一化参数U
% [out]W,返回基模的横向归一化参数W
%Author: yoyoba(stuyou@126.com)
%Date: 2012-5-30
%Modify: 2012-5-30
%=========================================================================
function [V,U,W]=f_LP01_V_U_W(nco,ncl,a,lamda)
    NA=sqrt(nco^2-ncl^2);
    V=2*pi*NA*a/lamda; %计算归一化频率
    Utemp=NaN;
    i=0;
    while(isnan(Utemp))
        try
        Utemp=fzero(@(Utemp) besselj(0,Utemp)/(Utemp*besselj(1,Utemp))...
            -besselk(0,sqrt(V^2-Utemp^2))/...
            (sqrt(V^2-Utemp^2)*besselk(1,sqrt(V^2-Utemp^2))),1.6);
        %使用fzero函数，对基模特征方程求解，计算Utemp
        catch
        end
        i=i+1;
    end
    U=Utemp;
    W=sqrt(V^2-U^2);
```

[下载源码](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/data/f_LP01_V_U_W.rar)