---
layout: post
title: 公式法，计算双芯光纤全耦合条件下，互耦合系数K随纤芯间距离d的变化关系
date: 2012-05-30 19:55:10 +0800
categories:
- Matlab
tags:
- TCF
- 互耦合系数
---

```matlab
%==========================================================================
%Name: K_d_formula.m，全耦合情况下，采用公式法，计算双芯光纤的互耦合系数K
%Desc: 双芯光纤在全耦合情况下，计算互耦合系数K随两个纤芯之间的距离d之间的关系
%求解思路：根据全耦合情况下，双芯光纤的互耦合系数的计算公式（参考范林勇博士
%论文P43,公式(2-100)），来计算K-d的关系。给定两个波长1310nm和1550nm，首先根据
%基模的特征方程，计算基模对应的U和W的值，然后代入K的表达式计算。
%Parameter:
%Return:
%Author: yoyoba(stuyou@126.com)
%Date: 2012-5-30
%Modify: 2012-6-3
%==========================================================================
clear;
close all;
clc;
lamda=[1310e-9,1550e-9]; %波长为1310nm和1500nm
a=4.1e-6; %纤芯半径4.1微米
nco=1.44902; %纤芯折射率
dn=0.005; %纤芯和包层折射率差
ncl=nco-dn; %包层折射率
d=8.2e-6:1e-7:20e-6; %双芯光纤两个纤芯之间的距离
NA=sqrt(nco^2-ncl^2); %数值孔径
N=length(lamda);
for j=1:N;
    V=2*pi*NA*a/lamda(j); %计算归一化频率
    Vtemp=V;
    Utemp=NaN;
    i=0;
    while(isnan(Utemp)&&i<N+1)
        init=Vtemp*(i+1)/N-eps;
        try
        Utemp=fzero(@(Utemp) besselj(0,Utemp)/(Utemp*besselj(1,Utemp))...
            -besselk(0,sqrt(Vtemp^2-Utemp^2))/...
            (sqrt(Vtemp^2-Utemp^2)*besselk(1,sqrt(Vtemp^2-Utemp^2))),init);
        %使用fzero函数，对基模特征方程求解，计算U
        catch
        end
        i=i+1;
    end
    U=Utemp;
    W=sqrt(V^2-U^2);
    K=NA*U^2*besselk(0,W*(d/a))/(nco*a*V^3*besselk(1,W)^2);%计算耦合系数K的公式
    if j==1
        plot(d*1e+6,K,'k'); %黑色曲线对应波长为1310nm
    else
        plot(d*1e+6,K,'r'); %红色曲线对应波长为1550nm
    end
    hold on;
    xlabel('d/um');
    ylabel('K/(1/m)');
    legend('1310nm','1550nm');
end
```

仿真结果：

![](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/image/K-d.jpg)

附件K_d_formula1.rar是使用了f_LP01_V_U_W( )函数实现了同样的同能。

[K_d_formula.rar](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/data/K_d_formula.rar) 

[f_LP01_V_U_W.rar](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/data/f_LP01_V_U_W.rar)

[K_d_formula1.rar](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/data/K_d_formula1.rar)
