---
layout: post
title:  数值积分法，全耦合条件下，计算双芯光纤互耦合系数K12随光波长lamda的关系
date: 2012-06-04 22:14:55 +0800
categories:
- Matlab
tags:
- TCF
- 互耦合系数
---


```matlab
%==========================================================================
%Name: K12_wavelength_num.m，采用数值积分法计算双芯光纤的互耦合系数K12。
%Desc: 计算互耦合系数K12随波长lamda之间的关系
%求解思路：根据互耦合系数K12最原始的积分表达式,参考范林勇博士论文P35,公式(2-50)，
%基模LP01模的解参考范林勇博士论文P40,公式(2-90)和公式(2-91),注意，往K12积分
%公式代入E2y(r)时，应把(2-91)中的r变成sqrt(d^2+y^2-2dycos(x))，因为(2-91)
%公式的坐标原点在第二个纤芯的轴心位置，而计算K12时，纤芯1和纤芯2的位置关系如P41的
%图2.4所示，此时纤芯2的轴心不再位于坐标原点。最后使用matlab的dblquad函数来计算K12。
%Parameter:
%Return:
%Author: yoyoba(stuyou@126.com)
%Date: 2012-6-4
%Modify: 2012-6-4
%==========================================================================
clear;
close all;
clc;
lamda=1400e-9:1e-10:1700e-9; %波长从1400nm到1700nm
a=4.1e-6; %纤芯半径4.1微米
nco=1.44902; %纤芯折射率
dn=0.005; %纤芯和包层折射率差
ncl=nco-dn; %包层折射率
d=15.e-6; %双芯光纤两个纤芯之间的距离
jd=8.854e-12; %真空介电常数
dc=4*pi*1.e-7; %真空磁导率
c=3e+8; %光速
z0=sqrt(dc/jd); %P40,公式（2-89）
alpha=asin(a/d); %极坐标积分区域的角度
Nlamda=length(lamda);
NA=sqrt(nco^2-ncl^2);
dtemp=d;
Ktemp=zeros(size(lamda));
for j=1:Nlamda
    omg=2*pi*c/lamda(j); 
    [V,U,W]=f_LP01_V_U_W(nco,ncl,a,lamda(j));
    E0=sqrt((pi*a^2*nco/(2*z0))*(besselj(0,U)^2+besselj(1,U)^2+besselj(0,U)^2*...
        (besselk(1,W)^2-besselk(0,W)^2)/besselk(0,W)^2))^-1;
    tol=1.e-10;
    Ktemp(j)=dblquad(@(x,y)(conj((besselj(0,U)*besselk(0,W*y/a)/besselk(0,W))).*...
        besselj(0,U*(sqrt(dtemp^2+y.^2-2*dtemp.*y.*cos(x)))/a).*y).*(y.^2-2*dtemp*y.*...
        cos(x)+dtemp^2-a^2<=0),-alpha,alpha,dtemp-a,dtemp+a,tol);
    K(j)=Ktemp(j)*omg*jd*(nco^2-ncl^2)*abs(E0)^2/4;
end
plot(lamda*1e+9,K);
xlabel('Wavelength(nm)');
ylabel('K(1/m)');
title('K-lamda');
```

仿真结果

![](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/image/K12-lamda.jpg)

[K12_wavelength_num.rar](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/data/K12_wavelength_num.rar)
