---
layout: post
title:  双芯光纤部分耦合情况下，纤芯1、2输出光功率随光纤长度的变化关系 
date: 2013-01-09 17:04:39 +0800
categories:
- Matlab
tags:
- TCF
---

%==========================================================================
%Name: tcf_nonfull_p_z.m，
%Desc: 双芯光纤(部分耦合情况),计算纤芯1、2输出功率随光纤长度z的变化情况，
%并画出范林勇博士论文P48，图2.11
%Parameter:
%Return:
%Author: yoyoba(stuyou@126.com)
%Date: 2013-1-9
%Modify: 2013-1-9
%==========================================================================
clear;
close all;
clc;
lamda=1550.e-9; %波长为1550nm
a1=4.1e-6; %纤芯1半径4.1微米
a2=3.9e-6; %纤芯2半径3.9微米、3.7微米
ncl=1.44402; %包层折射率
dn1=0.005; %纤芯1和包层折射率差
nco1=ncl+dn1; %纤芯1折射率
dn2=0.005; %纤芯2和包层折射率差
nco2=ncl+dn2; %纤芯2折射率
d=14.e-6; %双芯光纤两个纤芯之间的距离
jd=8.854e-12; %真空介电常数
dc=4*pi*1.e-7; %真空磁导率
c=3e+8; %光速
z0=sqrt(dc/jd); %范林勇博士论文P40,公式（2-89）
N=length(a2);
for j=1:N
    omg=2*pi*c/lamda;    %光场角频率 
    [V1,U1,W1]=f_LP01_V_U_W(nco1,ncl,a1,lamda);
    [V2,U2,W2]=f_LP01_V_U_W(nco2,ncl,a2,lamda);
    E01=sqrt((pi*a1^2*nco1/(2*z0))*(besselj(0,U1)^2+besselj(1,U1)^2+besselj(0,U1)^2*...
        (besselk(1,W1)^2-besselk(0,W1)^2)/besselk(0,W1)^2))^-1; %P40,公式（2-89）
    E02=sqrt((pi*a2^2*nco2/(2*z0))*(besselj(0,U2)^2+besselj(1,U2)^2+besselj(0,U2)^2*...
        (besselk(1,W2)^2-besselk(0,W2)^2)/besselk(0,W2)^2))^-1; %P40,公式（2-89）
    dtemp=d;
    alpha1=asin(a2/dtemp);
    tol=1.e-10;
% Ktemp12(j)=dblquad(@(x,y)(conj((besselj(0,U1)*besselk(0,W1*y/a1)/besselk(0,W1))).*...
% besselj(0,U2*(sqrt(dtemp^2+y.^2-2*dtemp.*y.*cos(x)))/a2).*y).*(y.^2-2*dtemp*y.*...
% cos(x)+dtemp^2-a2^2<=0),-alpha1,alpha1,dtemp-a2,dtemp+a2,tol)
% %计算K12的积分部分，柱坐标
    Ktemp12(j)=dblquad(@(x,y)(conj((besselj(0,U1)*besselk(0,W1*sqrt(x.^2+y.^2)/a1)/besselk(0,W1))).*...
        besselj(0,U2*(sqrt((x-dtemp).^2+y.^2))/a2)).*((x-dtemp).^2+y.^2<=a2^2),dtemp-a2,dtemp+a2,-a2,a2,tol); %计算K12的积分部分，直角坐标
    K12(j)=Ktemp12(j)*omg*jd*(nco2^2-ncl^2)*conj(E01)*E02/4;
% K12(j)=Ktemp12(j)*omg*jd*(nco2^2-ncl^2)*conj(E01)*E02/4; %计算K12 
% Mtemp1(j)=dblquad(@(x,y)abs((besselj(0,U1)*besselk(0,W1*y/a1)/besselk(0,W1))).^2.*y.*...
% (y.^2-2*dtemp*y.*cos(x)+dtemp^2-a2^2<=0),-alpha1,alpha1,dtemp
% -a2,dtemp+a2,tol); %计算M1的积分部分，柱坐标
    Mtemp1(j)=dblquad(@(x,y)abs((besselj(0,U1)*besselk(0,W1*sqrt(x.^2+y.^2)/a1)/besselk(0,W1))).^2.*...
        ((x-dtemp).^2+y.^2<=a2^2),dtemp-a2,dtemp+a2,-a2,a2,tol); %计算M1的积分部分，直角坐标
    M1(j)=Mtemp1(j)*omg*jd*(nco2^2-ncl^2)*abs(E01)^2/4;
% M1(j)=Mtemp1(j)*omg*jd*(nco2^2-ncl^2)*abs(E01)^2/4; %计算M1 


% Ktemp21(j)=dblquad(@(x,y)(conj((besselj(0,U2)*besselk(0,W2*sqrt(dtemp^2+y.^2-2*dtemp.*...
% y.*cos(x))/a2)/besselk(0,W2))).*besselj(0,U1*y/a1).*y),0,2*pi
% ,0,a1,tol); %计算K21的积分部分，柱坐标
    Ktemp21(j)=dblquad(@(x,y)(conj((besselj(0,U2)*besselk(0,W2*sqrt((x-dtemp).^2+y.^2)/a2)/besselk(0,W2))).*...
        besselj(0,U1*(sqrt(x.^2+y.^2)/a1)).*(x.^2+y.^2<=a1^2)),-a1,a1,-a1,a1,tol);
    K21(j)=Ktemp21(j)*omg*jd*(nco1^2-ncl^2)*E01*conj(E02)/4;
% K21(j)=Ktemp21(j)*omg*jd*(nco1^2-ncl^2)*E01*conj(E02)/4; %计算K21 ，直角坐标 
% Mtemp2(j)=dblquad(@(x,y)abs((besselj(0,U2)*besselk(0,W2*(sqrt(dtemp^2+y.^2-2*dtemp.*y.*...
% cos(x)))/a2)/besselk(0,W2))).^2.*(y),0,2*pi,0,a1,tol);
% %计算M2的积分部分，柱坐标
    Mtemp2(j)=dblquad(@(x,y)abs((besselj(0,U2)*besselk(0,W2*sqrt((x-dtemp).^2+y.^2)/a2)...
        /besselk(0,W2))).^2.*(x.^2+y.^2<=a1^2),-a1,a1,-a1,a1,tol); %计算M2的积分部分，直角坐标
    M2(j)=Mtemp2(j)*omg*jd*(nco1^2-ncl^2)*abs(E02)^2/4; 
% M2(j)=Mtemp2(j)*omg*jd*(nco1^2-ncl^2)*abs(E02)^2/4; %计算M2 

    Beff1(j)=sqrt(nco1^2-(U1*lamda/(2*pi*a1))^2); %有效折射率
    Beff2(j)=sqrt(nco2^2-(U2*lamda/(2*pi*a2))^2); %有效折射率
    delta(j)=((2*pi/lamda)*(Beff2(j)-Beff1(j))+M2(j)-M1(j))/2; %失谐因子
end
z=0:0.01e-3:20e-3;
Q=sqrt(delta.^2+K12.*K21);
A1=(cos(sqrt(delta^2+K12*K21)*z)+1i*delta*sin(sqrt(delta^2+K12*K21)*z)/sqrt(delta^2+K12*K21)).*exp(-1i*(M1+delta)*z);
A2=-1i*(K21*sin(sqrt(delta^2+K12*K21)*z)/sqrt(delta^2+K12*K21)).*exp(-1i*(M2-delta)*z);
p1=abs(A1).^2;
plot(z*1e+3,p1,'linewidth',2);
hold on;
p2=abs(A2).^2;
plot(z*1e+3,p2,'k','linewidth',2);
xlabel('z/mm');
ylabel('Normalized Power/a.u.');
legend('p1(z)','p2(z)');
title('a1=4.1\mum, a2=3.9\mum');
set(get(gca,'title'),'FontSize',20,'FontName','宋体');
set(get(gca,'XLabel'),'FontSize',14,'FontName','Times New Roman');
set(get(gca,'YLabel'),'FontSize',14,'FontName','Times New Roman');
hold off;

![](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/image/tcf_nonfull_p_z.jpg)

[tcf_nonfull_p_z.rar](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/data/tcf_nonfull_p_z.rar)