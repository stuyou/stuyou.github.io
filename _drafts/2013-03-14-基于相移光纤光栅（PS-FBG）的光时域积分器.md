---
layout: post
title: 基于相移光纤光栅（PS-FBG）的光时域积分器 
date: 2013-03-14 17:41:47 +0800
categories:
- Matlab
tags:
- 相移光纤光栅
- 积分
---

该积分器的理论分析参考文献：Asghari Mohammad H., Aza?a José. Design of all-optical high-order temporal integrators based on multiple-phase-shifted Bragg gratings.[J]. Optics Express, 2008, 16(15): 11459-11469.

仿真代码如下：

```matlab
%==========================================================================
%Name: ps_fbg_integrator.m，
%Desc: 相移光纤光栅光时域积分器仿真程序
%Parameter:
%Return:
%Author: yoyoba(stuyou@126.com)
%Date: 2013-3-12
%Modify: 2013-3-14
%==========================================================================
clear;
clc;
close all;
lambdaB=1553.3e-9; %积分器中心波长
lambdalow=lambdaB-0.002e-9;
lambdaup=lambdaB+0.002e-9;
lambda=lambdalow:1e-16:lambdaup;
period=534.89e-9; %光栅周期；
L1=2057*period; %长度一定为周期的整数倍
L2=2168*period; %长度一定为周期的整数倍
deltaneff=2.6e-3; %光栅折射率调制
neff=lambdaB/(2*period); %有效折射率
beta=2*pi*neff./lambda;
delta=beta-pi/period;
kc=pi*deltaneff./lambda;
gama=sqrt(kc.^2-delta.^2);
t111=(cosh(gama*L1)+j*delta.*sinh(gama*L1)./gama)...
    *exp(j*2*pi*neff*L1/lambdaB);
t122=conj(t111);
t112=-(kc./gama).*sinh(gama*L1)*exp(-j*2*pi*neff*L1/lambdaB);
t121=conj(t112); %FBG1传输矩阵元素

t211=(cosh(gama*L2)+j*delta.*sinh(gama*L2)./gama)...
    *exp(j*2*pi*neff*L2/lambdaB);
t222=conj(t211);
t212=-(kc./gama).*sinh(gama*L2)*exp(-j*2*pi*neff*L2/lambdaB);
t221=conj(t212); %FBG2传输矩阵元素

faie=pi;
fai11=exp(-j*faie/2);
fai22=conj(fai11);
fai12=0;
fai21=0; %相移矩阵元素

T22=t221*fai11.*t112+t222*fai22.*t122;
tao=1./T22; %相移FBG的透射率，利用透射特性，来进行积分。

figure;
plot(lambda*1e+9,abs(tao)/max(abs(tao)),'r','linewidth',4);
axis([lambdalow*1e+9,lambdaup*1e+9,0,1]);
xlabel('Wavelength(nm)');
ylabel('Amplitude(a.u.)');
title('PS-FBG积分器幅度谱');
figure;
plot(lambda*1e+9,angle(tao),'b','linewidth',4);
axis([lambdalow*1e+9,lambdaup*1e+9,-1,4]);
xlabel('Wavelength(nm)');
ylabel('Phase(rad)');
title('PS-FBG积分器相位谱');
%以上得到PS-FBG的传输谱

%以下为验证积分效果
time_width=100e-12; %高斯脉冲时间宽度
order=1; %高斯脉冲阶数
dorder=1; %输入的高斯脉冲微分阶数，本仿真输入的高斯脉冲为1阶微分
c=3e+8;
Ns=2.e+3; 
Ts=10*time_width/Ns; %对高斯脉冲，仿真时间宽度为高斯脉冲时间宽度的100倍 
n=floor(-(Ns-1)/2:(Ns-1)/2);
t=n*Ts;
g=exp(-0.5*(t/time_width).^(2*order)); 
k=floor(-(Ns-1)/2:(Ns-1)/2);
D=1/(Ns*Ts); 
G=fftshift(fft(g)); 
f=k*D+c/lambdaB; 
lambda=c./f;

beta=2*pi*neff./lambda;
delta=beta-pi/period;
kc=pi*deltaneff./lambda;
gama=sqrt(kc.^2-delta.^2);
t111=(cosh(gama*L1)+j*delta.*sinh(gama*L1)./gama)...
    *exp(j*2*pi*neff*L1/lambdaB);
t122=conj(t111);
t112=-(kc./gama).*sinh(gama*L1)*exp(-j*2*pi*neff*L1/lambdaB);
t121=conj(t112); %FBG1传输矩阵元素

t211=(cosh(gama*L2)+j*delta.*sinh(gama*L2)./gama)...
    *exp(j*2*pi*neff*L2/lambdaB);
t222=conj(t211);
t212=-(kc./gama).*sinh(gama*L2)*exp(-j*2*pi*neff*L2/lambdaB);
t221=conj(t212); %FBG2传输矩阵元素

faie=pi;
fai11=exp(-j*faie/2);
fai22=conj(fai11);
fai12=0;
fai21=0; %相移矩阵元素

T22=t221*fai11.*t112+t222*fai22.*t122;
tao=1./T22; %相移FBG的透射率，利用透射特性，来进行积分。

H=-1i*(k)*D; %一阶微分理论传输函数 
n_d_in_f=G.*H.^dorder; %n阶理论高斯微分脉冲，输入脉冲（频域）
n_d_in_t=ifft(n_d_in_f); %n阶理论高斯微分脉冲，输入脉冲（时域）

ideal_inte_f=G.*H.^(dorder-1); %积分理论值（频域）
ideal_inte_t=ifft(ideal_inte_f); %积分理论值（时域）

real_inte_f=n_d_in_f.*tao; %PSFBG积分后输出的脉冲（频域）
real_inte_t=ifft(real_inte_f); %PSFBG积分后输出的脉冲（时域）
figure;
plot(t*1e+12,abs(real_inte_t)/max(abs(real_inte_t)),'r','linewidth',2);
hold on
plot(t*1e+12,abs(ideal_inte_t)/max(abs(ideal_inte_t)),'b','linewidth',2);
plot(t*1e+12,abs(n_d_in_t)/max(abs(n_d_in_t)),'k','linewidth',2);
xlabel('Time(ps)');
ylabel('Amplitude(a.u.)');
legend('实际积分脉冲','理论积分脉冲','输入脉冲');
```

运行结果：

1.PS-FBG的幅度谱

![](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/image/psfbgint_a-l.jpg)

2.PS-FBG的相位谱

![](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/image/psfbgint_p-l.jpg)

3.积分结果

![](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/image/psfbgint.jpg)

[ps_fbg_integrator.rar](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/data/ps_fbg_integrator.rar)