---
layout: post
title:  双芯光纤，部分耦合情况下，互耦合系数、自耦合系数、相位失谐量的计算 
date: 2012-07-10 14:26:13 +0800
categories:
- Matlab
tags:
- TCF
- 互耦合系数
- 自耦合系数
- 相位失谐量
---

```matlab
%==========================================================================
%Name: tcf_diff_nonfull.m，
%Desc: 双芯光纤(部分耦合情况),计算互耦合系数K12、K21和自耦合系数M1、M2，以及
%失谐因子，并画出范林勇博士论文P50，图2.12
%Parameter:
%Return:
%Author: yoyoba(stuyou@126.com)
%Date: 2012-7-9
%Modify: 2012-7-10
%==========================================================================
clear;
% close all;
clc;
% lamda=1300.e-9:1.e-9:1600.e-9; %波长为1310nm和1550nm
lamda=1550.e-9; %波长
a1=4.1e-6; %纤芯1半径4.1微米
a2=3.9e-6; %纤芯2半径
dn1=0.005; %纤芯1和包层折射率差
dn2=0.005; %纤芯2和包层折射率差 
ncl=1.44402; %包层折射率
nco1=ncl+dn1; %纤芯1折射率
nco2=ncl+dn2; %纤芯2折射率
d=10.e-6:1e-7:20.e-6; %双芯光纤两个纤芯之间的距离
jd=8.854e-12; %真空介电常数
dc=4*pi*1.e-7; %真空磁导率
c=3e+8; %光速
z0=sqrt(dc/jd); %范林勇博士论文P40,公式（2-89）
N=length(d);
Nlamda=length(lamda);
Ktemp12=zeros(size(lamda));
Ktemp21=zeros(size(lamda));
K12=zeros(size(lamda));
K21=zeros(size(lamda));
Mtemp1=zeros(size(lamda));
Mtemp2=zeros(size(lamda));
M1=zeros(size(lamda));
M2=zeros(size(lamda));
Beff1=zeros(size(lamda));
Beff2=zeros(size(lamda));
delta=zeros(size(lamda));
xK12(i)=zeros(size(d));
xK21(i)=zeros(size(d));
xdel(i)=zeros(size(d));
for i=1:N
    for j=1:Nlamda
        omg=2*pi*c/lamda(j);    %光场角频率 
        [V1,U1,W1]=f_LP01_V_U_W(nco1,ncl,a1,lamda(j));
        [V2,U2,W2]=f_LP01_V_U_W(nco2,ncl,a2,lamda(j));
        E01=sqrt((pi*a1^2*nco1/(2*z0))*(besselj(0,U1)^2+besselj(1,U1)^2+besselj(0,U1)^2*...
            (besselk(1,W1)^2-besselk(0,W1)^2)/besselk(0,W1)^2))^-1; %P40,公式（2-89）
        E02=sqrt((pi*a2^2*nco2/(2*z0))*(besselj(0,U2)^2+besselj(1,U2)^2+besselj(0,U2)^2*...
            (besselk(1,W2)^2-besselk(0,W2)^2)/besselk(0,W2)^2))^-1; %P40,公式（2-89）
        dtemp=d(i);
        alpha1=asin(a2/dtemp);
        tol=1.e-15;
        Ktemp12(j)=dblquad(@(x,y)(conj((besselj(0,U1)*besselk(0,W1*y/a1)/besselk(0,W1))).*...
            besselj(0,U2*(sqrt(dtemp^2+y.^2-2*dtemp.*y.*cos(x)))/a2).*y).*(y.^2-2*dtemp*y.*...
            cos(x)+dtemp^2-a2^2<=0),-alpha1,alpha1,dtemp-a2,dtemp+a2,tol); %计算K12的积分部分
        K12(j)=Ktemp12(j)*omg*jd*(nco2^2-ncl^2)*conj(E01)*E02/4; %计算K12 
        Mtemp1(j)=dblquad(@(x,y)abs((besselj(0,U1)*besselk(0,W1*y/a1)/besselk(0,W1))).^2.*y.*...
            (y.^2-2*dtemp*y.*cos(x)+dtemp^2-a2^2<=0),-alpha1,alpha1,dtemp-a2,dtemp+a2,tol); %计算M1的积分部分
        M1(j)=Mtemp1(j)*omg*jd*(nco2^2-ncl^2)*abs(E01)^2/4; %计算M1 


        Ktemp21(j)=dblquad(@(x,y)(conj((besselj(0,U2)*besselk(0,W2*sqrt(dtemp^2+y.^2-2*dtemp.*...
            y.*cos(x))/a2)/besselk(0,W2))).*besselj(0,U1*y/a1).*y),0,2*pi,0,a1,tol); %计算K21的积分部分
        K21(j)=Ktemp21(j)*omg*jd*(nco1^2-ncl^2)*E01*conj(E02)/4; %计算K21 
        Mtemp2(j)=dblquad(@(x,y)abs((besselj(0,U2)*besselk(0,W2*(sqrt(dtemp^2+y.^2-2*dtemp.*y.*...
            cos(x)))/a2)/besselk(0,W2))).^2.*(y),0,2*pi,0,a1,tol); %计算M2的积分部分
        M2(j)=Mtemp1(j)*omg*jd*(nco1^2-ncl^2)*abs(E02)^2/4; %计算M2 

        Beff1(j)=sqrt(nco1^2-(U1*lamda(j)/(2*pi*a1))^2); %有效折射率
        Beff2(j)=sqrt(nco2^2-(U2*lamda(j)/(2*pi*a2))^2); %有效折射率
        delta(j)=((2*pi/lamda(j))*(Beff2(j)-Beff1(j))+M2(j)-M1(j))/2; %失谐因子
    end
    xK12(i)=K12(j);
    xK21(i)=K21(j);
    xdel(i)=delta(j);
end

plot(d*1e+6,xdel.^2./(xK12.*xK21));
xlabel('mm');
```

结果
![](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/image/tcf_diff_nonfull.jpg)

[tcf_diff_nonfull.rar](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/data/tcf_diff_nonfull.rar) 