---
layout: post
title: 相移光纤光栅微分器仿真程序
date: 2012-12-08 22:46:52 +0800
categories:
- Matlab
tags:
- 相移光纤光栅
- 微分
---

```matlab
%==========================================================================
%Name: ps_fbg1_fgb2_diff_verify.m
%Desc: 相移均匀布拉格光栅微分器仿真，画出相移均匀布拉格光栅反射率振幅和相位随
%波长的变化关系。并输入高斯脉冲 ，使用该微分器，输出高斯微分脉冲
%并计算差错因子和能量效率。
%参考文献:"N. K. Berger, B. Levit, B. Fischer, M. Kulishov, D. V. 
%Plant, and J. Azana, "Temporal differentiation of optical signals using a 
%phase-shifted fiber Bragg grating," Opt. Express 15, 371-381 (2007)."
%Parameter:
%Return:
%Author: yoyoba(stuyou@126.com)
%Date: 2012-6-1
%Modify: 2012-12-09
%==========================================================================
clc;
clear;
close all;
c=3e+8; %光速
Ns=2e+3; %抽样点数2000
fwhm=1000.e-12; %输入高斯脉冲时间宽度1000ps
order=1; %高斯脉冲阶数
Ts=100*fwhm/Ns; %取样时间宽口宽度为100*fwhm，样点个数2000
n=floor(-(Ns-1)/2:(Ns-1)/2);
t=n*Ts;
g=exp(-0.5*(t/fwhm).^(2*order)); %输入高斯脉冲时间
k=floor(-(Ns-1)/2:(Ns-1)/2);
D=1/(Ns*Ts); %频率分辨率
G=fftshift(fft(g)); %高斯信号频谱
kk=0:Ns-1;
E=Ts/Ns*sum(abs(G(kk+1)).^2); %输入高斯脉冲的能量
f=k*D+c/1550.e-9; %高斯脉冲的中心波长位于1550nm，
                    %该波长应与后续输入的光栅布拉格波长lamdaB保持一致
lamda=c./f;

%相移光纤光栅参数
neff=1.46; %有效折射率
lamdaB=1550.e-9; %谐振布拉格波长
N1=1884; %光栅1周期数
N2=1884; %光栅2周期数
ac1=7.5e-4; %光栅1交流折射率变化，详见“饶云江《光纤光栅原理及应用》p121”
ac2=7.5e-4; %光栅2交流折射率变化。
k1=pi*ac1./lamda; %光栅1模式耦合系数，详见“饶云江《光纤光栅原理及应用》p114，公式(4.15)”
k2=pi*ac2./lamda; %光栅2模式耦合系数
period=lamdaB/(2*neff); %光栅周期
L1=N1*period; %光栅1长度
L2=N2*period; %光栅1长度
del_beta=2*pi*neff*(lamda.^-1-lamdaB^-1); %模式失谐量，详见“饶云江《光纤光栅原理及应用》p113，公式(4.13)”
gama1=sqrt(k1.^2-del_beta.^2);
gama2=sqrt(k2.^2-del_beta.^2);
g_L1=gama1*L1;
g_L2=gama2*L2;
t111=(cosh(g_L1)+1i*del_beta.*L1.*sinh(g_L1)./(g_L1)).*...
    exp(1i*2*pi*neff*L1/lamdaB); %相移光栅传输矩阵T111元素
t211=(cosh(g_L2)+1i*del_beta.*L2.*sinh(g_L2)./(g_L2)).*...
    exp(1i*2*pi*neff*L2/lamdaB); %相移广汉传输矩阵T211元素
t112=-(L1*k1.*sinh(g_L1)./g_L1).*exp(-1i*2*pi*neff*L1/lamdaB);
t212=-(L2*k2.*sinh(g_L2)./g_L2).*exp(-1i*2*pi*neff*L2/lamdaB);
t121=conj(t112);
t221=conj(t212);
t122=conj(t111);
t222=conj(t211);
r1=t121./t111;
r2=t221./t211;
tao1=1./t111;
tao2=1./t211;
fai1=angle(tao1);
fai2=angle(tao2);
sita=pi; %两个光栅之间的相移角度，PI。
r=(r1+r2.*exp(1i*(sita+2*fai1)))./(1+conj(r1).*r2.*...
    exp(1i*(sita+2*fai1))); %相移光栅反射谱

%下面计算相移光栅反射谱的3dB带宽
sample_number=length(r);
[minr,iminr]=min(abs(r));
[maxr,imaxr]=max(abs(r));
rhalf1=r(1:iminr);
rhalf1d=abs(rhalf1)-0.5*maxr;
[minrhalf1,iminhalf1]=min(abs(rhalf1d));
lamda3db1=lamda(iminhalf1); %3dB带宽的FH
rhalf2=r(iminr:sample_number);
rhalf2d=abs(rhalf2)-0.5*maxr;
[minrhalf2,iminhalf2]=min(abs(rhalf2d));
lamda3db2=lamda(iminhalf2+(iminr-1)); %3dB带宽的FL
lamda3db=lamda3db1-lamda3db2;%3dB带宽=FH-FL

GG=G.*r; %相移光栅输出高斯微分脉冲频谱
iGG=ifft(GG); %傅里叶逆变换，高斯微分脉冲时域波形
H=-1i*(k)*D; %一阶微分理论传输函数
ideal_GG=G.*H; %高斯一阶微分理论频谱
ideal_iGG=ifft(ideal_GG); %高斯一阶微分理论时域波形
%计算误差因子
ft=(abs(iGG)/max(abs(iGG))).^2;
gt=(abs(ideal_iGG)/max(abs(ideal_iGG))).^2;
De=(sum(ft-gt)/sum(gt)); 

EE=(Ts/Ns*sum(abs(GG(kk+1)).^2)); %输出高斯脉冲的能量
ER=EE/E; %能量效率
disp(strcat('该微分器的差错因子为：',num2str(De)));
disp(strcat('该微分器的能量效率为：',num2str(ER)));

figure
plot(lamda*1e+9,abs(r),'k'); 
xlabel('Wavelength/nm');
ylabel('Field reflective')
hold on;

%以下画出3dB带宽曲线
xx1=[lamda3db1,lamda3db1]*1e+9;
xx2=[lamda3db2,lamda3db2]*1e+9;
yy1=[0,0.5*maxr];
yy2=[0.5*maxr,0.5*maxr];
xx3=[lamda3db1,lamda3db2]*1e+9;
plot(xx1,yy1,'r:');
plot(xx2,yy1,'r:');
plot(xx3,yy2,'r:');
text((lamdaB+lamda3db)*1e+9,0.25*maxr,strcat('3dB带宽',...
    num2str(lamda3db*1e+9),'纳米'));

figure
plot(lamda*1e+9,angle(r),'k'); %相移光栅相位谱
xlabel('Wavelength/nm');
ylabel('phase/rad');

figure
plot(t*1e+12,abs(iGG)/max(abs(iGG)),'r'); %使用相移光栅输出的高斯一阶微分脉冲
hold on
plot(t*1e+12,abs(g)/max(abs(g)),'b--'); %原始高斯脉冲
plot(t*1e+12,abs(ideal_iGG)/max(abs(ideal_iGG)),'ko') %高斯理论一阶微分脉冲
axis([-fwhm*6*1e+12,fwhm*6*1e+12,0,1]);
xlabel('时间(ps)');
ylabel('归一化振幅(a.u.)');
title('高斯一阶微分脉冲');
legend('高斯一阶微分脉冲',strcat('原始',num2str(order),'阶高斯脉冲'),...
    '高斯一阶微分脉冲理论波形');
```

输出结果：

该微分器的差错因子为：0.0010161

该微分器的能量效率为：0.00046005

![](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/image/psfbg-a-l.jpg)

![](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/image/psfbg-p-l.jpg)

![](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/image/psfbg-diff.jpg)

[ps_fbg1_fbg2_diff_verify.rar](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/data/ps_fbg1_fbg2_diff_verify.rar) 

[参考文献](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/data/ref1.pdf) 