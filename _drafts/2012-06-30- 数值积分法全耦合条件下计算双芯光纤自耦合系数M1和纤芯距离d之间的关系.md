---
layout: post
title:  数值积分法，全耦合条件下，计算双芯光纤自耦合系数M1和纤芯距离d之间的关系
date: 2012-06-03 10:55:47 +0800
categories:
- Matlab
tags:
- TCF
- 自耦合系数
---

```matlab
%==========================================================================
%Name: M1_d_num_inte.m，采用数值积分法计算双芯光纤的自耦合系数M1。
%Desc: 计算自耦合系数M1随两个纤芯之间的距离d之间的关系
%求解思路：根据自耦合系数M1最原始的积分表达式,参考范林勇博士论文P35,公式(2-49)，
%基模LP01模的解参考范林勇博士论文P40,公式(2-90)。最后使用matlab的dblquad函数来
%计算M1。
%Parameter:
%Return:
%Author: yoyoba(stuyou@126.com)
%Date: 2012-6-3
%Modify: 2012-6-3
%==========================================================================
clear;
% close all;
clc;
lamda=[1310.e-9,1550.e-9]; %波长为1310nm和1550nm
a=4.1e-6; %纤芯半径4.1微米
nco=1.44902; %纤芯折射率
dn=0.005; %纤芯和包层折射率差
ncl=nco-dn; %包层折射率
d=8.2e-6:1.e-7:20.e-6; %双芯光纤两个纤芯之间的距离
jd=8.854e-12; %真空介电常数
dc=4*pi*1.e-7; %真空磁导率
c=3e+8; %光速
z0=sqrt(dc/jd); %P40,公式（2-89）
N=length(d);
Nlamda=length(lamda);
Mtemp=zeros(size(d));
M1=zeros(size(d));
for j=1:Nlamda
    omg=2*pi*c/lamda(j);    %光场角频率 
    [V,U,W]=f_LP01_V_U_W(nco,ncl,a,lamda(j));
    E0=sqrt((pi*a^2*nco/(2*z0))*(besselj(0,U)^2+besselj(1,U)^2+besselj(0,U)^2*...
        (besselk(1,W)^2-besselk(0,W)^2)/besselk(0,W)^2))^-1; %P40,公式（2-89）
    for i=1:N
        dtemp=d(i);
        alpha=asin(a/dtemp);
        tol=1.e-10;
        
        Mtemp(i)=dblquad(@(x,y)abs((besselj(0,U)*besselk(0,W*y/a)/besselk(0,W))).^2.*y.*(y.^2-2*dtemp*y.*...
            cos(x)+dtemp^2-a^2<=0),-alpha,alpha,dtemp-a,dtemp+a,tol); %计算M1的积分部分
        
        M1(i)=Mtemp(i)*omg*jd*(nco^2-ncl^2)*abs(E0)^2/4; %计算M1 
    end
    if j==1
        plot(d*1e+6,M1,'k');
    else
        plot(d*1e+6,M1,'r');
    end
    hold on;
    xlabel('d(um)');
    ylabel('M1(1/m)');
    legend('1310nm','1550nm');
end
```

仿真结果

![](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/image/M1-d.jpg)

[M1_d_num_inte.rar](https://github.com/stuyou/stuyou.github.io/raw/master/_posts/data/M1_d_num_inte.rar)